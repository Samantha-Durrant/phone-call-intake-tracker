:root{--bg:#ffffff;--text:#1f2937;--muted:#6b7280;--line:#e5e7eb;--brand:#4f46e5;--brand-2:#6366f1;--accent:#10b981;--danger:#ef4444;--chip:#f3f4f6;--chip-alt:#eef2ff}

*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Cantarell,Noto Sans,sans-serif;color:var(--text);background:#f5f7fb}

.demo-bar{position:fixed;top:16px;left:16px;z-index:9;display:flex;gap:8px;align-items:center;background:#fff;border:1px solid var(--line);border-radius:10px;padding:8px 10px;box-shadow:0 8px 24px rgba(0,0,0,.08)}
.demo-label{font-size:13px;color:#374151}
.demo-select{height:34px;border:1px solid var(--line);border-radius:8px;padding:0 8px;font-size:14px}
.demo-bar button{height:34px;border-radius:8px;border:1px solid var(--line);background:#fff;cursor:pointer;padding:0 10px;font-weight:600}
.demo-bar .primary{background:var(--brand);border-color:var(--brand);color:#fff}
.demo-bar .primary:hover{background:#4338ca}

.mini-screenpop{position:fixed;right:16px;bottom:16px;width:min(25vw,460px);min-width:320px;max-width:460px;background:var(--bg);border:1px solid var(--line);border-radius:12px;box-shadow:0 12px 40px rgba(0,0,0,.12);display:flex;flex-direction:column;max-height:calc(100vh - 32px);overflow:hidden}
.mini-body{flex:1;overflow:auto;-webkit-overflow-scrolling:touch}
.mini-header{position:sticky;top:0;z-index:2}
.mini-footer{position:sticky;bottom:0;z-index:2}

.mini-header{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;background:linear-gradient(180deg,#f9fafb,#f3f4f6);border-bottom:1px solid var(--line)}
.title{display:flex;align-items:center;gap:8px;font-weight:600}
.icon-btn{border:none;background:transparent;width:32px;height:32px;border-radius:8px;display:grid;place-items:center;color:var(--muted);cursor:pointer}
.icon-btn:hover{background:#eef2ff;color:#4338ca}

.section{padding:12px}
.section+.section{border-top:1px solid var(--line)}
.section-title{display:flex;align-items:center;gap:10px;font-size:14px;margin:0 0 10px;color:#111827}

.grid{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.field{display:flex;flex-direction:column;gap:4px}
.label{font-size:12px;color:var(--muted)}
.field input,.field select{height:34px;padding:6px 8px;border:1px solid var(--line);border-radius:8px;font-size:14px;background:#fff;color:var(--text)}
.field input:focus,.field select:focus{outline:none;border-color:var(--brand-2);box-shadow:0 0 0 3px rgba(99,102,241,.15)}

.chips{display:flex;align-items:center;gap:10px;margin-top:8px}
.chip{font-size:12px;background:var(--chip);padding:6px 8px;border-radius:999px;color:#111827}
.chip.alt{background:var(--chip-alt);color:#3730a3}

.toggle{position:relative;width:48px;height:26px}
.toggle input{position:absolute;opacity:0;width:0;height:0}
.toggle label{display:block;width:100%;height:100%;background:#d1d5db;border-radius:999px;cursor:pointer;transition:background .2s ease;position:relative}
.toggle label:after{content:"";position:absolute;top:3px;left:3px;width:20px;height:20px;background:#fff;border-radius:50%;box-shadow:0 1px 2px rgba(0,0,0,.15);transition:transform .2s ease}
.toggle input:checked+label{background:#4f46e5}
.toggle input:checked+label:after{transform:translateX(22px)}

.row{display:flex;align-items:flex-start;justify-content:space-between;gap:10px;margin:10px 0;flex-wrap:wrap}
.segmented{display:flex;flex-wrap:wrap;row-gap:6px;column-gap:6px;background:#f3f4f6;border:1px solid var(--line);border-radius:10px;padding:4px}
.seg{border:none;background:transparent;padding:6px 10px;border-radius:8px;cursor:pointer;color:#374151;font-size:13px}
.seg.active{background:#fff;border:1px solid var(--line)}

/* Highlight active selection for patient type using brand color */
.pt-type.segmented{border-color:var(--line)}
.pt-type .seg.active{border-color:var(--brand);color:var(--brand)}

.reason{display:grid;grid-template-columns:1fr;gap:8px;margin-top:8px}
.reason-toggle-list{display:flex;flex-wrap:wrap;gap:6px}
.reason-toggle{border:1px solid var(--line);background:#fff;border-radius:999px;padding:6px 12px;font-size:13px;cursor:pointer;color:#1f2937;transition:border-color .2s ease,background .2s ease,color .2s ease}
.reason-toggle:focus{outline:none;border-color:var(--brand-2);box-shadow:0 0 0 3px rgba(99,102,241,.15)}
.reason-toggle.is-selected{background:var(--chip-alt);border-color:var(--brand-2);color:#3730a3}
.reason-toggle[aria-pressed="true"]{background:var(--chip-alt);border-color:var(--brand-2);color:#3730a3}
.reason-toggle.is-disabled{opacity:.55;cursor:default}
.hidden{display:none!important}

.reasons{display:flex;flex-direction:column;gap:8px}
.reason-row{display:flex;align-items:flex-start;justify-content:space-between;padding:8px 10px;border:1px solid var(--line);border-radius:8px;background:#fff;gap:8px}
.reason-label{font-size:14px;flex:1;min-width:0;word-break:break-word}
.actions{display:flex;gap:6px;flex-wrap:wrap;justify-content:flex-end}
.mini-btn{border:1px solid var(--line);background:#fff;color:#111827;border-radius:8px;height:28px;padding:0 10px;font-size:12px;cursor:pointer}
.mini-btn:hover{border-color:var(--brand-2);color:#3730a3}
.mini-btn.alt{background:#f8fafc}
.mini-btn.pressed{background:var(--chip-alt);border-color:var(--brand-2);color:#3730a3}

.checkbox{display:inline-flex;align-items:center;gap:8px}
.checkbox input{display:none}
.checkmark{width:20px;height:20px;border-radius:6px;border:1px solid var(--line);display:grid;place-items:center;background:#fff;cursor:pointer}
.checkbox input:checked+.checkmark{background:var(--accent);border-color:var(--accent)}
.checkbox input:checked+.checkmark:after{content:"âœ“";color:#fff;font-size:13px;line-height:1}

.mini-footer{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-top:1px solid var(--line);background:linear-gradient(180deg,#f9fafb,#f3f4f6)}
.muted{color:var(--muted)}
.btn{height:32px;padding:0 12px;border-radius:8px;border:1px solid var(--line);background:#fff;cursor:pointer;font-weight:600;color:#111827}
.btn.ghost{background:#fff}
.btn.primary{background:var(--brand);border-color:var(--brand);color:#fff}
.btn.primary:hover{background:#4338ca}

/* Household chooser and banners */
.banner{display:flex;align-items:flex-start;gap:10px;padding:10px;border:1px dashed var(--line);border-radius:8px;background:#f8fafc;flex-wrap:wrap}
.chooser{border:1px solid var(--line);border-radius:10px;padding:8px;background:#fff;margin-top:8px}
.chooser-header{font-weight:600;margin-bottom:6px}
.chooser-list{display:flex;flex-direction:column;gap:8px}
.chooser-item{display:flex;align-items:flex-start;justify-content:space-between;padding:8px 10px;border:1px solid var(--line);border-radius:8px;background:#fff;gap:8px}
.chooser-item .meta{font-size:12px;color:var(--muted)}

@media (max-width: 980px){.mini-screenpop{width:min(42vw,460px)}}
@media (max-width: 640px){
  .mini-screenpop{left:16px;right:16px;width:auto}
  .demo-bar{position:static;margin:12px}
  .demo-bar{flex-wrap:wrap}
  .segmented{width:100%}
  .row{gap:12px}
  .reason-row{flex-wrap:wrap}
  .actions{width:100%;justify-content:flex-start}
}
